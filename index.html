<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>üß† 30 —Å“±—Ä–∞“õ—Ç—ã“õ —Ç–µ—Å—Ç</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { width: 100%; height: 100%; }
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background: #e2e8f0;
      color: #2d3748;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .container {
      width: 100%;
      max-width: 400px;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 90vh;
      overflow: hidden;
    }
    .header { text-align: center; margin-bottom: 10px; }
    .header h1 { font-size: 1.6rem; color: #3182ce; }
    .progress { font-size: 0.9rem; color: #4a5568; margin-bottom: 10px; text-align: right; }
    .question-area { flex: 1; overflow-y: auto; margin-bottom: 10px; }
    .question-text { font-size: 1.2rem; font-weight: 600; margin-bottom: 12px; line-height: 1.4; white-space: pre-wrap; }
    .code-block {
      background: #1a202c;
      color: #f7fafc;
      border-radius: 12px;
      padding: 12px;
      font-family: 'Courier New', monospace;
      font-size: 0.95rem;
      margin-bottom: 12px;
      overflow-x: auto;
    }
    .variants { display: grid; grid-template-columns: 1fr; gap: 8px; }
    .variant {
    font-size: 1rem;
      display: flex;
      align-items: center;
      background: #edf2f7;
      border-radius: 12px;
      padding: 12px;
      margin-top: 10px;
      cursor: pointer;
      transition: transform 0.2s, background 0.2s;
    }
    .variant:hover { background: #bee3f8; transform: scale(1.02); }
    .variant.selected { background: #90cdf4; border: 2px solid #3182ce; }
    .variant input { margin-right: 12px; transform: scale(1.3); }
    .controls { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
    .btn {
      flex: 1;
      padding: 14px;
      font-size: 1.5rem;
      border: none;
      border-radius: 12px;
      color: #fff;
      background: linear-gradient(135deg, #3182ce, #2c5282);
      cursor: pointer;
      transition: background 0.3s;
    }
    .btn:disabled { background: #a0aec0; cursor: not-allowed; }
    .results { text-align: center; font-size: 1.1rem; overflow-y: auto; max-height: 80vh; }
    .results .score { font-size: 1.5rem; font-weight: bold; margin-bottom: 12px; color: #2c5282; }
    .review-item {
      background: #fefcbf;
      border-left: 4px solid #ecc94b;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 10px;
      text-align: left;
    }
    .wrong { background: #fed7d7; border-left-color: #e53e3e; }
    .correct { background: #c6f6d5; border-left-color: #38a169; }
    .review-question { font-weight: bold; margin-bottom: 6px; }
    .review-answer { margin-left: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üß† 30 —Å“±—Ä–∞“õ—Ç—ã“õ —Ç–µ—Å—Ç</h1>
    </div>
    <div class="progress" id="progress"></div>
    <div class="question-area" id="question-area"></div>
    <div class="controls">
      <button id="next-btn" class="btn" disabled>–ö–µ–ª–µ—Å—ñ</button>
    </div>
    <div id="results" class="results" style="display:none;"></div>
  </div>

  <script>
    let questions = [], current = 0, answers = [];
    async function load() {
      const res = await fetch('test1.xml');
      const xml = new DOMParser().parseFromString(await res.text(), 'application/xml');
      const all = Array.from(xml.getElementsByTagName('question')).map(q => {
        const text = q.getElementsByTagName('text')[0].textContent.trim();
        const variants = Array.from(q.getElementsByTagName('variant')).map(v => v.textContent.trim());
        const correct = variants[0];
        const shuffled = variants.map(v=>({v,id:Math.random()})).sort((a,b)=>a.id-b.id).map(x=>x.v);
        return { text, variants: shuffled, correctIndex: shuffled.indexOf(correct), correctAnswer: correct };
      });
      questions = all.sort(()=>0.5-Math.random()).slice(0,1);
      render();
    }
    function render() {
      document.getElementById('results').style.display='none';
      const area = document.getElementById('question-area');
      area.innerHTML = '';
      document.getElementById('progress').textContent = `${current+1} / ${questions.length}`;
      const q = questions[current];
      const qt = document.createElement('div'); qt.className='question-text'; qt.textContent=q.text;
      area.appendChild(qt);
      q.variants.forEach((v,i)=>{
        const lbl=document.createElement('label'); lbl.className='variant';
        lbl.onclick=()=>select(lbl);
        const inp=document.createElement('input'); inp.type='radio'; inp.name='opt'; inp.value=i;
        lbl.appendChild(inp);
        lbl.appendChild(document.createTextNode(v));
        area.appendChild(lbl);
      });
      document.getElementById('next-btn').disabled=true;
    }
    function select(lbl){
      document.querySelectorAll('.variant').forEach(el=>el.classList.remove('selected'));
      lbl.classList.add('selected');
      document.querySelector('.variant input:checked').checked=true;
      document.getElementById('next-btn').disabled=false;
    }
    document.getElementById('next-btn').onclick=()=>{
      const sel = document.querySelector('input[name="opt"]:checked');
      answers.push(+sel.value);
      if(current+1<questions.length){ current++; render(); }
      else finish();
    };
    function finish(){
      document.getElementById('question-area').style.display='none';
      document.querySelector('.controls').style.display='none';
      const res = document.getElementById('results');
      let corr=0;
      questions.forEach((q,i)=>{ if(answers[i]===q.correctIndex) corr++; });
      const pct = Math.round(corr/questions.length*100);
      let html = `<div class='score'>${corr}/${questions.length}</div><div>${pct}%</div><hr style='margin:10px 0'>`;
      questions.forEach((q,i)=>{
        const userAnswer = q.variants[answers[i]];
        const correctAnswer = q.variants[q.correctIndex];
        const isCorrect = answers[i] === q.correctIndex;
        html += `<div class='review-item ${isCorrect ? "correct" : "wrong"}'>`;
        html += `<div class='review-question'>${i+1}) ${q.text}</div>`;
        if (!isCorrect) html += `<div class='review-answer'><strong>–°—ñ–∑–¥—ñ“£ –∂–∞—É–∞–±—ã“£—ã–∑:</strong> ${userAnswer}</div>`;
        html += `<div class='review-answer'><strong>–î“±—Ä—ã—Å –∂–∞—É–∞–ø:</strong> ${correctAnswer}</div>`;
        html += `</div>`;
      });
      res.innerHTML = html;
      res.style.display='block';
    }
    load();
  </script>
</body>
</html>
